{% extends "base.html" %}
{% block title %}Punteggio di {{ user.username }}{% endblock %}
{% block content %}

<style>
.match-cell {
  background-color: #d1e7dd !important;
  font-weight: bold;
}
.malus-cell {
  background-color: #f8d7da !important;
  font-weight: bold;
}
.table th, .table td {
  vertical-align: middle;
}
.score-card th,
.score-card td {
  padding: 0.45rem 0.6rem !important;
  font-size: 0.95rem;
  line-height: 1.2;
}
.center { text-align: center; }

.score-header {
  background: linear-gradient(135deg, #dc3545, #b02a37);
  color: white;
  border-radius: 20px;
  padding: 12px 16px;
  margin-bottom: 28px;
  box-shadow: 0 10px 26px rgba(220,53,69,.45);
}
.score-label {
  text-transform: uppercase;
  letter-spacing: 0.1em;
  font-size: 0.7rem;
}

.score-card {
  border-radius: 20px;
  padding: 20px;
  margin-bottom: 32px;
  box-shadow: 0 10px 28px rgba(0,0,0,.10);
}
.card-classifica {
  background: linear-gradient(135deg, #e7f1ff, #f9fbff);
  border-left: 10px solid #0d6efd;
}
.card-premi {
  background: linear-gradient(135deg, #fff3cd, #fffaf0);
  border-left: 10px solid #ffc107;
}
.card-duetti {
  background: linear-gradient(135deg, #f3e8ff, #fbf7ff);
  border-left: 10px solid #6f42c1;
}
.card-title {
  font-size: 1.35rem;
  margin-bottom: 12px;
}
</style>

<a href="{{ url_for('ranking') }}" class="btn btn-outline-primary mb-3">
‚¨Ö Torna alla classifica
</a>

<!-- HEADER -->
<div class="score-header text-center">
  <h4 class="mb-1">{{ user.username }}</h4>
  <h2 class="mb-0">{{ "%.1f"|format(total) }}</h2>
  <h10 class="mb-0">PUNTEGGIO TOTALE</h10>
</div>

<!-- ================= CLASSIFICA ================= -->
<div class="score-card card-classifica">
  <div class="card-title">üèÜ Classifica principale</div>

  <table class="table mt-2">
    <thead>
      <tr>
        <th>Artista</th>
        <th class="center">Tu</th>
        <th class="center">Ufficiale</th>
        <th class="center">Punti</th>
      </tr>
    </thead>
    <tbody>
    {% for row in breakdown.classifica.details %}
      <tr>
        <td>{{ row.name }}</td>
        <td class="center">{{ row.predicted }}</td>
        <td class="center">{{ row.official }}</td>
        <td class="center {% if row.points > 0 %}match-cell{% endif %}">
          {{ row.points }}
        </td>
      </tr>
    {% endfor %}
    </tbody>
  </table>

  <p class="text-center">
    <strong>Totale classifica principale:</strong> {{ breakdown.classifica.total }}
  </p>


  <p class="text-center mt-2 {% if breakdown.bonus %}match-cell{% endif %}">
    <strong>Bonus BUGO:</strong> {{ breakdown.bonus }}
  </p>
  <p class="text-center {% if breakdown.malus %}malus-cell{% endif %}">
    <strong>Malus MORGAN:</strong> {{ breakdown.malus }}
  </p>
</div>

<!-- ================= PREMI ================= -->
<div class="score-card card-premi">
  <div class="card-title">üèÖ Premi inutili</div>

  <table class="table">
    <thead>
      <tr>
        <th>Premio</th>
        <th class="center">Tu</th>
        <th class="center">Ufficiale</th>
        <th class="center">Punti</th>
      </tr>
    </thead>
    <tbody>
    {% for row in breakdown.premi.details %}
      <tr>
        <td>{{ row.label }}</td>
        <td class="center">{{ row.user }}</td>
        <td class="center">{{ row.official }}</td>
        <td class="center {% if row.points > 0 %}match-cell{% endif %}">
          {{ row.points }}
        </td>
      </tr>
    {% endfor %}
    </tbody>
  </table>

  <p class="text-center">
    <strong>Totale premi:</strong> {{ breakdown.premi.total }}
  </p>
</div>

<!-- ================= DUETTI ================= -->
<div class="score-card card-duetti">
  <div class="card-title">üé∂ Duetti di merda</div>

  <table class="table">
    <thead>
      <tr>
        <th>Duetto</th>
        <th class="center">Tu</th>
        <th class="center">Ufficiale</th>
        <th class="center">Punti</th>
      </tr>
    </thead>
    <tbody>
    {% for row in breakdown.duetti.details %}
      <tr>
        <td>{{ row.name }}</td>
        <td class="center">{{ row.predicted }}</td>
        <td class="center">{{ row.official }}</td>
        <td class="center {% if row.points > 0 %}match-cell{% endif %}">
          {{ row.points }}
        </td>
      </tr>
    {% endfor %}
    </tbody>
  </table>

  <p class="text-center">
    <strong>Totale duetti:</strong> {{ breakdown.duetti.total }}
  </p>
</div>

{% endblock %}




